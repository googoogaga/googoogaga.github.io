<!-- MHonArc v2.5.2 -->
<!--X-Subject: Goo porting questions -->
<!--X-From-R13: Quevf Rbhoyr <puevfNqbhoyr.pb.am> -->
<!--X-Date: Fri, 26 Jul 2002 23:18:41 &#45;0400 (EDT) -->
<!--X-Message-Id: ueldpj1tv.fsf@double.co.nz -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Goo porting questions</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00095.html">Date Prev</a>][<a href="msg00097.html">Date Next</a>][<a href="msg00092.html">Thread Prev</a>][<a href="msg00100.html">Thread Next</a>][<a href="index.html#00096">Date Index</a>][<a href="threads.html#00096">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Goo porting questions</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <A HREF="mailto:googoogaga@DOMAIN.HIDDEN">googoogaga@xxxxxxxxxx</A></li>
<li><em>Subject</em>: Goo porting questions</li>
<li><em>From</em>: Chris Double &lt;<A HREF="mailto:chris@DOMAIN.HIDDEN">chris@xxxxxxxxxxxx</A>&gt;</li>
<li><em>Date</em>: 27 Jul 2002 15:18:20 +1200</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
I've been working some more on the Win32 MSVC port and I've got a
couple of questions/comments.

Currently I'm not using 'inline' functions with MSVC because I get
linker errors like the following:

%lock.obj : error LNK2001: unresolved external symbol _allocate
math.obj : error LNK2001: unresolved external symbol _YPfi2f
math.obj : error LNK2001: unresolved external symbol _YPfE
math.obj : error LNK2001: unresolved external symbol _YPfL
math.obj : error LNK2001: unresolved external symbol _YPfA
math.obj : error LNK2001: unresolved external symbol _YPf_
[...snip...]

This is caused by functions defined in grt.c as inline. In MSVC all
inline functions must exist in a header file included by the .c file
that uses them, otherwise they'll not be linked at all as they don't
'exist' having been inlined in the module where they live (grt.c).

What's a good way of working around this? Move the INLINE functions in
grt.c to a header file? Don't make them inline? 

In the meantime I'm creating a LOCAL_INLINE which is 'inline' for gcc
and nothing for MSVC and I'll modify the grt.c inline functions to use
this. The inline functions in grt.h will remain as INLINE. Maybe not a
good long term solution as it causes a lot of functions that could be
inline to not be inlined. I'd like to opt for moving them into grt.h
or another header file perhaps? Thoughts?

I could leave inline out completely for MSVC but it makes Goo a bit
slower.

My other question is what to do about generating makefiles for
MSVC. Currently I see the makefile is generated by 'generate-makefile'
in g2c.goo and it uses Gnu makefiles.

What's a good way of adding support for generating makefiles for
Microsoft make? Or for other build systems (I'd like to get support
going for Symbian operating systems for example which uses their own
make type system).

Is it worth adding some sort of c-backend identifier that things like
generate-makefile can dispatch on? Or does that add too much knowledge
to the Goo code about the build system? Other ideas?

Chris.


</pre>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00100" href="msg00100.html">Re: Goo porting questions</a></strong>
<ul><li><em>From:</em> Jonathan Bachrach</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00095.html">Re: image saving</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00097.html">Errors in %event.c, %lock.c</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00092.html">More on loop problem</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00100.html">Re: Goo porting questions</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="index.html#00096"><strong>Date</strong></a></li>
<li><a href="threads.html#00096"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
