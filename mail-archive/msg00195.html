<!-- MHonArc v2.5.2 -->
<!--X-Subject: Re: Problems with libraries using C &#45; code -->
<!--X-From-R13: Oaqerj Ehgureynaq <fbzoerebNnv.zvg.rqh> -->
<!--X-Date: Fri, 27 Sep 2002 22:44:02 &#45;0400 (EDT) -->
<!--X-Message-Id: uqzadm225qo.fsf@bongo.ai.mit.edu -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20020923043614.GA4544@vomjom -->
<!--X-Reference: 4984.24.91.160.204.1032764055.squirrel@languor.static.net -->
<!--X-Reference: uo8lm5s1hmy.fsf@djundjun.ai.mit.edu -->
<!--X-Reference: 1033160242.672.8.camel@CoolLaptop -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: Problems with libraries using C - code</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00194.html">Date Prev</a>][<a href="msg00196.html">Date Next</a>][<a href="msg00194.html">Thread Prev</a>][<a href="msg00197.html">Thread Next</a>][<a href="index.html#00195">Date Index</a>][<a href="threads.html#00195">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Problems with libraries using C - code</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Benedikt Grundmann &lt;<A HREF="mailto:Benedikt-Grundmann@DOMAIN.HIDDEN">Benedikt-Grundmann@xxxxxx</A>&gt;</li>
<li><em>Subject</em>: Re: Problems with libraries using C - code</li>
<li><em>From</em>: Andrew Sutherland &lt;<A HREF="mailto:sombrero@DOMAIN.HIDDEN">sombrero@xxxxxxxxxx</A>&gt;</li>
<li><em>Date</em>: 27 Sep 2002 22:43:59 -0400</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>

Currently, to use modules that use .c files, you must build a new goo
image with those modules included.

For example, to build network sockets in to the goo image, you would:

- Edit src/eval/main.goo, and add the following line:

(use goo/io/net)

- Then, in the REPL of a running goo:

(use eval/g2c)
(g2c-test &quot;magic&quot;) ;; sets the output dir to &quot;g2c-magic&quot; off of goo/c
(g2c-top) ;; builds a new image in &quot;g2c-magic&quot;

- Then, in your shell, in goo/c

make sub=g2c-magic

Then you have a new executable in goo/c/g2c-magic called g2c-magic,
which has the desired module already built in.

It's generally preferred when doing this to only include the core
libraries and not the application level code, thus minimizing the
amount of dynamic compilation required (and also having it work).

This obviously isn't the long-term solution, but I'm not sure that the
solution is entirely trivial, so it might be a few days.  The
obviously bad thing that is happening is that the dynamic compilation
is trying to compile and link the net.goo file without its %net.c
file, but I think the problem extends slightly further than that,
resulting in the dl's not properly generating extern's to the other C
file.  (The dynamic and image compilation steps are fairly different.)

Andrew


</pre>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00197" href="msg00197.html">Re: Problems with libraries using C - code</a></strong>
<ul><li><em>From:</em> Benedikt Grundmann</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00187" href="msg00187.html">goo is missing...</a></strong>
<ul><li><em>From:</em> Jonathan Hseu</li></ul></li>
<li><strong><a name="00188" href="msg00188.html">Re: goo is missing...</a></strong>
<ul><li><em>From:</em> James Knight</li></ul></li>
<li><strong><a name="00191" href="msg00191.html">Re: goo is missing...</a></strong>
<ul><li><em>From:</em> Jonathan Bachrach</li></ul></li>
<li><strong><a name="00194" href="msg00194.html">Problems with libraries using C - code</a></strong>
<ul><li><em>From:</em> Benedikt Grundmann</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00194.html">Problems with libraries using C - code</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00196.html">put james knight's masters thesis on www.googoogaga.org</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00194.html">Problems with libraries using C - code</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00197.html">Re: Problems with libraries using C - code</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="index.html#00195"><strong>Date</strong></a></li>
<li><a href="threads.html#00195"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
